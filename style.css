/* ==========================================================================
   СТИЛИ ПО УМОЛЧАНИЮ (MOBILE FIRST)
   ========================================================================== */
:root {
    --primary-blue: #3b82f6; --primary-blue-hover: #2563eb; --accent-purple: #8b5cf6;
    --light-blue-bg: #eff6ff; --text-primary: #1e293b; --text-secondary: #64748b;
    --background-main: #f8fafc; --background-card: #ffffff; --border-color: #e2e8f0;
    --shadow-sm: 0 1px 3px rgba(0,0,0,.05); --shadow-md: 0 4px 12px rgba(0,0,0,.08);
    --shadow-lg: 0 10px 30px rgba(0,0,0,.12); --success-color: #10b981; --error-color: #ef4444;
    --favorite-color: #facc15; --ripple-color: rgba(0, 0, 0, 0.1);
}
body.dark-mode {
    --primary-blue: #60a5fa; --primary-blue-hover: #3b82f6; --accent-purple: #a78bfa;
    --light-blue-bg: #1e293b; --text-primary: #f1f5f9; --text-secondary: #94a3b8;
    --background-main: #0f172a; --background-card: #1e293b; --border-color: #334155;
    --shadow-sm: 0 1px 3px rgba(0,0,0,.3); --shadow-md: 0 4px 12px rgba(0,0,0,.4);
    --shadow-lg: 0 10px 30px rgba(0,0,0,.5); --favorite-color: #fde047;
    --ripple-color: rgba(255, 255, 255, 0.1);
}
* { box-sizing: border-box; }
html { scroll-behavior: smooth; }
body {
    margin: 0; font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    background-color: var(--background-main); color: var(--text-primary);
    transition: background-color .3s ease, color .3s ease; line-height: 1.6;
    overflow-x: hidden; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
}
#app-container { padding-bottom: 56px; /* Высота Bottom Bar */ }
.login-active { overflow: hidden; height: 100vh; }

/* --- ОСНОВНАЯ СТРУКТУРА МОБИЛЬНОЙ ВЕРСИИ --- */
.mobile-header {
    background-color: var(--background-card); padding: 12px 16px;
    text-align: center; border-bottom: 1px solid var(--border-color);
    position: sticky; top: 0; z-index: 100;
}
.mobile-header-title { font-size: 18px; font-weight: 600; margin: 0; }
#mobile-main-content { padding: 16px; }
.mobile-page { display: none; animation: fadeIn .3s ease-in-out; }
.mobile-page.active { display: block; }
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

/* Скрытие десктопных элементов на мобильных */
header, main { display: none; }

/* --- НИЖНЯЯ ПАНЕЛЬ НАВИГАЦИИ (BOTTOM BAR) --- */
.bottom-bar {
    position: fixed; bottom: 0; left: 0; width: 100%; height: 56px;
    background-color: var(--background-card); border-top: 1px solid var(--border-color);
    display: flex; justify-content: space-around; align-items: center; z-index: 1000;
    box-shadow: 0 -2px 10px rgba(0,0,0,.05);
}
.bottom-bar-btn {
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    background: none; border: none; color: var(--text-secondary);
    font-size: 10px; font-weight: 500; flex-grow: 1; height: 100%;
    transition: color .2s ease; padding: 4px 0;
}
.bottom-bar-btn.active { color: var(--primary-blue); }
.bottom-bar-btn svg { width: 24px; height: 24px; margin-bottom: 2px; }

/* --- СТРАНИЦА "ШАБЛОНЫ" (АККОРДЕОНЫ) --- */
.search-wrapper { margin-bottom: 16px; }
#mobileSearchInput {
    width: 100%; padding: 14px 16px; border: 1px solid var(--border-color);
    border-radius: 12px; font-size: 15px; background-color: var(--background-card);
    color: var(--text-primary);
}
.sidebar-section h2 {
    font-size: 14px; font-weight: 600; margin: 16px 0 8px; color: var(--text-secondary);
    padding: 8px; border-radius: 8px; position: relative; cursor: pointer;
    background-color: var(--background-card); border: 1px solid var(--border-color);
}
.sidebar-section h2::after {
    content: '▼'; position: absolute; right: 16px; top: 50%;
    transform: translateY(-50%); transition: transform .2s ease; font-size: 12px;
}
.sidebar-section.active h2::after { transform: translateY(-50%) rotate(180deg); }
.sidebar-section .buttons-container { display: none; padding-top: 8px; }
.sidebar-section.active .buttons-container { display: block; }

.sidebar-button {
    display: flex; align-items: center; width: 100%;
    height: 48px; padding: 0 12px; margin-bottom: 12px;
    background-color: var(--background-card); border: 1px solid var(--border-color);
    border-radius: 16px; font-size: 15px; font-weight: 500; text-align: left;
    color: var(--text-primary); cursor: pointer; position: relative; overflow: hidden;
    box-shadow: var(--shadow-sm);
}
.sidebar-button svg { width: 20px; height: 20px; margin-right: 12px; color: var(--text-secondary); }
.sidebar-button:active { transform: scale(0.98); background-color: var(--light-blue-bg); }

/* --- Ripple Effect --- */
.ripple { position: absolute; border-radius: 50%; background: var(--ripple-color); transform: scale(0); animation: ripple .6s linear; }
@keyframes ripple { to { transform: scale(4); opacity: 0; } }

/* --- СТРАНИЦА "ИНСТРУКЦИИ" И "АНАЛИТИКА" --- */
.instructions { font-size: 16px; line-height: 1.7; }
.instructions h3 { font-size: 22px; }
.analytics-placeholder { text-align: center; padding: 40px 20px; color: var(--text-secondary); }
.kpi-grid { display: flex; flex-direction: column; gap: 16px; }
.kpi-card { background-color: var(--background-card); padding: 20px; border-radius: 16px; border: 1px solid var(--border-color); }
.kpi-card-title { font-size: 14px; color: var(--text-secondary); margin: 0 0 8px 0; }
.kpi-card-value { font-size: 28px; font-weight: 700; color: var(--primary-blue); margin: 0; }

/* --- ПАНЕЛЬ "МЕНЮ" (BOTTOM SHEET) --- */
.menu-panel-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background-color: rgba(0,0,0,0.4); z-index: 2000;
    opacity: 0; pointer-events: none; transition: opacity .3s ease;
}
.menu-panel-overlay.show { opacity: 1; pointer-events: auto; }
.menu-panel {
    position: absolute; bottom: 0; left: 0; width: 100%;
    background-color: var(--background-card);
    border-top-left-radius: 20px; border-top-right-radius: 20px;
    padding: 12px 16px 24px;
    transform: translateY(100%); transition: transform .3s ease-out;
}
.menu-panel-overlay.show .menu-panel { transform: translateY(0); }
.menu-panel-handle { width: 40px; height: 4px; background-color: var(--border-color); border-radius: 2px; margin: 0 auto 16px; }
.menu-profile { text-align: center; margin-bottom: 16px; padding-bottom: 16px; border-bottom: 1px solid var(--border-color); }
.menu-profile-name { font-size: 18px; font-weight: 600; margin: 0; }
.menu-profile-role { font-size: 14px; color: var(--text-secondary); margin-top: 4px; }
.menu-item { display: flex; justify-content: space-between; align-items: center; padding: 14px 8px; font-size: 16px; }
.menu-item-btn { width: 100%; border-radius: 12px; background-color: var(--primary-blue); color: #fff; border: none; padding: 14px; font-size: 16px; font-weight: 600; margin-top: 16px; }
.menu-item-logout { width: 100%; background: none; border: none; color: var(--error-color); padding: 14px 8px; font-size: 16px; margin-top: 8px; text-align: center; }

/* --- ЭКРАН "РЕДАКТОР" --- */
.editor-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: var(--background-main); z-index: 1001; transform: translateX(100%); transition: transform 0.3s ease-in-out; }
.editor-screen.active { transform: translateX(0); }
.editor-header { display: flex; justify-content: space-between; align-items: center; }
.editor-back-btn, .editor-save-btn { background: none; border: none; font-size: 16px; font-weight: 600; color: var(--primary-blue); padding: 8px; }
.editor-tabs-container { display: flex; overflow-x: auto; border-bottom: 1px solid var(--border-color); background-color: var(--background-card); -webkit-overflow-scrolling: touch; }
.editor-tabs-container::-webkit-scrollbar { display: none; }
.editor-tab { padding: 14px 16px; border: none; background: none; font-size: 15px; font-weight: 600; color: var(--text-secondary); white-space: nowrap; border-bottom: 2px solid transparent; }
.editor-tab.active { color: var(--primary-blue); border-bottom-color: var(--primary-blue); }
.editor-content-container { padding: 16px; height: calc(100% - 105px); overflow-y: auto; }

/* Общие стили для форм в редакторе */
.editor-section { border: 1px solid var(--border-color); border-radius: 16px; padding: 16px; background-color: var(--background-card); margin-bottom: 16px; }
.editor-section h4 { margin-top: 0; }
.editor-section input, .editor-section textarea, .editor-section select { width: 100%; padding: 12px; border-radius: 12px; border: 1px solid var(--border-color); background-color: var(--background-main); font-size: 14px; margin-bottom: 12px; }
.add-btn { width: 100%; height: 48px; border-radius: 16px; }

/* --- Остальные утилитарные стили --- */
.toast-notification, .modal-overlay, .login-form-container, .animation-overlay, #login-screen {
    /* Стили для этих элементов остаются практически без изменений, т.к. они уже адаптивны */
}
.login-form-container { width: 90%; padding: 32px 24px; }
.modal-content { width: 90%; }

/* ==========================================================================
   СТИЛИ ДЛЯ ДЕСКТОПА (Экраны > 768px)
   ========================================================================== */
@media (min-width: 769px) {
    /* Сюда перенесены ВСЕ старые стили для десктопа */
    body { overflow: hidden; }
    #app-container { padding-bottom: 0; }
    header, main { display: flex; }
    .mobile-header, #mobile-main-content, .bottom-bar, .menu-panel-overlay, .editor-screen { display: none !important; }

    #app-container:not([data-logged=true]){display:none}
    #animation-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:var(--background-main);display:none;justify-content:center;align-items:center;z-index:3000;opacity:1;transition:opacity .5s ease-out}.animation-content h1{font-size:56px;background:linear-gradient(135deg,var(--primary-blue),var(--accent-purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;letter-spacing:-2px;font-weight:700;opacity:0}#animation-overlay.animate .animation-content h1{animation:fadeInOut 2.5s ease-in-out forwards}@keyframes fadeInOut{0%{opacity:0;transform:scale(.9)}20%{opacity:1;transform:scale(1)}80%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.9)}}header{text-align:center;padding:24px 20px;font-size:28px;font-weight:700;border-bottom:1px solid var(--border-color);letter-spacing:-1px;background-color:var(--background-card);transition:all .3s ease;box-shadow:var(--shadow-sm);flex-shrink:0}main{flex:1;overflow:hidden; flex-direction: row;}
    .sidebar{width:340px;min-width:300px;padding:24px;border-right:1px solid var(--border-color);background-color:var(--background-card);box-sizing:border-box;display:flex;flex-direction:column;transition:all .3s ease;overflow-y:hidden}
    .sidebar-scrollable-content{overflow-y:auto;flex-grow:1;margin-right:-12px;padding-right:12px}
    .sidebar h2{font-size:13px;margin-bottom:12px;font-weight:600;margin-top:24px;color:var(--text-secondary);padding-left:8px;text-transform:uppercase;letter-spacing:.5px; cursor: default;}
    .sidebar-section h2::after { content: ''; }
    .sidebar-section.active h2::after { transform: none; }
    .sidebar h2:first-of-type{margin-top:0}
    .search-wrapper{padding-bottom:16px;border-bottom:1px solid var(--border-color);margin-bottom:16px}
    #searchInput{width:100%;padding:14px 16px;border:2px solid var(--border-color);border-radius:12px;font-size:15px;background-color:var(--background-main);color:var(--text-primary);font-family:inherit;transition:all .2s ease}#searchInput:focus{outline:none;border-color:var(--primary-blue);box-shadow:0 0 0 4px rgba(59,130,246,.1)}
    .sidebar-footer{flex-shrink:0;padding-top:16px;margin-top:16px;border-top:1px solid var(--border-color);background-color:var(--background-card)}
    .sidebar-section .buttons-container{display:block}
    .sidebar-section .sidebar-button{position:relative;display:flex;align-items:center;gap:12px;width:100%;padding:14px 16px;margin-bottom:8px;background-color:var(--background-main);border:1px solid var(--border-color);border-radius:12px;font-size:15px;font-weight:500;text-align:left;color:var(--text-primary);cursor:pointer;transition:all .2s ease;box-shadow:var(--shadow-sm)}
    .sidebar-section .sidebar-button:hover{border-color:var(--primary-blue);color:var(--primary-blue);background-color:var(--light-blue-bg);transform:translateY(-2px);box-shadow:var(--shadow-md)}
    .sidebar-section .sidebar-button svg{width:20px;height:20px;flex-shrink:0;stroke-width:2;color:var(--text-secondary);transition:color .2s ease}
    .sidebar-section .sidebar-button:hover svg{color:var(--primary-blue)}
    .sidebar-footer button{display:flex;align-items:center;gap:12px;width:100%;padding:14px 16px;margin-bottom:8px;background-color:var(--background-main);border:1px solid var(--border-color);border-radius:12px;font-size:15px;font-weight:500;text-align:left;color:var(--text-primary);cursor:pointer;transition:all .2s ease;box-shadow:var(--shadow-sm)}
    .sidebar-footer button:hover{border-color:var(--primary-blue);color:var(--primary-blue);background-color:var(--light-blue-bg);transform:translateY(-2px);box-shadow:var(--shadow-md)}
    .favorite-star{position:absolute;top:6px;right:6px;font-size:24px;color:var(--border-color);cursor:pointer;transition:all .2s ease;padding:4px;line-height:1;border-radius:50%}
    .sidebar-button:hover .favorite-star{color:var(--text-secondary)}
    .favorite-star:hover{transform:scale(1.2);color:var(--favorite-color)!important;background-color:var(--light-blue-bg)}
    .favorite-star.favorited{color:var(--favorite-color)!important;text-shadow:0 0 8px var(--favorite-color)}
    #favorites-section h2{color:var(--favorite-color);border-bottom:1px solid var(--favorite-color);padding-bottom:8px;margin-bottom:16px}
    .info{flex:1;padding:40px;overflow-y:auto;background-color:var(--background-main); display: block !important;}
    .info-header-controls{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;gap:20px}
    #user-status-card{background-color:var(--background-card);border:1px solid var(--border-color);border-radius:12px;padding:16px;font-size:14px;line-height:1.6;box-shadow:var(--shadow-sm);flex-grow:1;max-width:400px}
    .manager-controls-segmented { display: flex !important; background-color: var(--background-main); border-radius: 10px; padding: 4px; border: 1px solid var(--border-color); position: relative; }
    .manager-controls-segmented button { background: none; border: none; padding: 8px 16px; font-size: 14px; font-weight: 600; border-radius: 7px; cursor: pointer; color: var(--text-secondary); transition: color .2s ease; z-index: 2; white-space: nowrap; }
    .manager-controls-segmented button.active { color: #fff; }
    .manager-controls-segmented .glider { position: absolute; height: calc(100% - 8px); background-color: var(--primary-blue); border-radius: 7px; transition: all .3s cubic-bezier(0.4, 0, 0.2, 1); z-index: 1; top: 4px; box-shadow: 0 2px 8px rgba(59,130,246,.3); }
    .instructions{margin-top:20px}.instructions h3{font-size:32px;font-weight:700;margin-bottom:16px;color:var(--text-primary);letter-spacing:-1px}
    .instructions ul,.instructions ol{padding-left:24px;margin:12px 0;color:var(--text-secondary);line-height:1.8}
    .instructions li{margin-bottom:8px}#analytics-panel{display:none;flex-grow:1;height:100%}
    .analytics-container{display:flex;height:100%;background-color:var(--background-main)}
    .analytics-sidebar{width:300px;background-color:var(--background-card);border-right:1px solid var(--border-color);display:flex;flex-direction:column}
    .analytics-sidebar-header{padding:20px;border-bottom:1px solid var(--border-color)}
    .analytics-period-selector{display:flex;gap:8px}
    .analytics-period-selector button{flex-grow:1;padding:8px 12px;border-radius:8px;border:1px solid var(--border-color);background-color:transparent;color:var(--text-secondary);font-weight:600;cursor:pointer;transition:all .2s ease}
    .analytics-period-selector button.active{background-color:var(--primary-blue);color:#fff;border-color:var(--primary-blue)}
    .employee-list{list-style:none;margin:0;padding:0;overflow-y:auto}
    .employee-list li{padding:16px 20px;cursor:pointer;border-bottom:1px solid var(--border-color);display:flex;justify-content:space-between;align-items:center;transition:background-color .2s ease}
    .employee-list li:hover{background-color:var(--light-blue-bg)}
    .employee-list li.active{background-color:var(--primary-blue);color:#fff}
    .employee-list .employee-name{font-weight:600}
    .employee-list .employee-clicks{font-size:14px;opacity:.7}
    .employee-list li.active .employee-clicks{opacity:1}
    .analytics-main{flex-grow:1;padding:32px;overflow-y:auto}
    .analytics-main-header{margin-bottom:24px}
    .analytics-main-header h2{margin:0;font-size:28px}
    .analytics-main-header p{margin:4px 0 0 0;color:var(--text-secondary)}
    .kpi-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-bottom:32px}
    .analytics-section{background-color:var(--background-card);padding:24px;border-radius:12px;border:1px solid var(--border-color);margin-bottom:24px}
    .analytics-section h4{margin-top:0}
    .analytics-table{width:100%;border-collapse:collapse;font-size:14px}
    .analytics-table th,.analytics-table td{padding:12px 16px;text-align:left;border-bottom:1px solid var(--border-color)}
    .analytics-table th{font-weight:600;color:var(--text-secondary)}
    .analytics-table tr:last-child td{border-bottom:none}
    .analytics-table td:last-child{text-align:right}
    .analytics-table .count-cell{font-weight:600;color:var(--primary-blue)}
    .analytics-table .time-cell{color:var(--text-secondary)}
    #analytics-loader,.no-data-message{padding:60px;text-align:center;color:var(--text-secondary);font-size:18px}
    .theme-switch-wrapper{display:flex;align-items:center;justify-content:space-between;padding:12px 8px}
    .theme-switch-label{font-weight:500;color:var(--text-secondary);font-size:14px}
    .theme-switch{display:inline-block;height:28px;position:relative;width:52px}
    .theme-switch input{display:none}
    .slider{background-color:#cbd5e1;bottom:0;cursor:pointer;left:0;position:absolute;right:0;top:0;transition:.3s}
    .slider:before{background-color:#fff;bottom:4px;content:"";height:20px;left:4px;position:absolute;transition:.3s;width:20px;box-shadow:0 2px 4px rgba(0,0,0,.2)}
    input:checked+.slider{background-color:var(--primary-blue)}
    input:checked+.slider:before{transform:translateX(24px)}
    .slider.round{border-radius:34px}.slider.round:before{border-radius:50%}
    #language-switcher-app{display:flex;justify-content:space-around;padding:12px 0;border-bottom:1px solid var(--border-color);margin-bottom:12px}
    #language-switcher-app button{background:none;border:none;font-weight:600;color:var(--text-secondary);cursor:pointer;padding:8px 16px;margin:0;font-size:14px;border-radius:8px;transition:all .2s ease}
    #language-switcher-app button:hover{background-color:var(--light-blue-bg);color:var(--primary-blue)}
    #language-switcher-app button.active{color:var(--primary-blue);background-color:var(--light-blue-bg)}
    .editor-main-controls{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;flex-wrap:wrap;gap:16px}
    .editor-tabs{display:flex;gap:8px;background-color:var(--background-card);padding:6px;border-radius:12px;border:1px solid var(--border-color)}
    .editor-tabs button{padding:10px 20px;border:none;background-color:transparent;font-size:15px;font-weight:600;border-radius:8px;cursor:pointer;color:var(--text-secondary);transition:all .2s ease}
    .editor-tabs button.active{background-color:var(--primary-blue);color:#fff;box-shadow:0 2px 8px rgba(59,130,246,.3)}
    .editor-panel{display:none}.editor-panel.active{display:block}
    .editor-buttons{display:flex;gap:12px}
    .editor-buttons button{padding:12px 24px;font-size:15px;font-weight:600;border-radius:12px;cursor:pointer;border:none;transition:all .2s ease}
    #save-content-btn{background-color:var(--primary-blue);color:#fff;box-shadow:0 2px 8px rgba(59,130,246,.3)}
    #save-content-btn:hover{background-color:var(--primary-blue-hover);transform:translateY(-2px);box-shadow:0 4px 12px rgba(59,130,246,.4)}
    #cancel-edit-btn{background-color:var(--background-card);color:var(--text-primary);border:1px solid var(--border-color)}
    #cancel-edit-btn:hover{background-color:var(--background-main)}
    #add-user-form { grid-template-columns: 1fr 1fr 1fr auto; }
}